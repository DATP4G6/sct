species Citizen(int townId) {
    state Alive {
        enter Alive;
    }
}

species Town(int id, int citizenCount) {
    decorator updateCitizenCount {
        citizenCount = count(Citizen::?(townId: id));
    }

    @updateCitizenCount
    state Stable {
        create Citizen::Alive(townId: id);
        enter Stable;
    }
}

function setup() -> void {
    create Town::Stable(id: 1, citizenCount: 0);
    create Citizen::Alive(townId: 1);
    exitAfterTicks(2);
}
